{
  "schema_version": "1.0",
  "description": "Database structure for SpeakSphere, designed with privacy and security as priorities.",
  "collections": {
    "users": {
      "description": "Stores anonymized information about users interacting with the system.",
      "fields": [
        {
          "name": "user_id",
          "type": "UUID",
          "description": "A unique, non-identifiable primary key for each user."
        },
        {
          "name": "hashed_contact_info",
          "type": "String (SHA-256 Hash)",
          "description": "Hashed representation of the user's primary contact detail (e.g., phone number) to prevent direct identification."
        },
        {
          "name": "preferences",
          "type": "Object",
          "properties": {
            "language": "String (ISO 639-1)",
            "communication_channel": "Enum ('sms', 'email', 'phone')",
            "consent_for_recording": "Boolean"
          }
        },
        {
          "name": "created_at",
          "type": "Timestamp"
        }
      ]
    },
    "call_logs": {
      "description": "Contains metadata and anonymized transcripts of phone interactions.",
      "fields": [
        {
          "name": "call_id",
          "type": "UUID",
          "description": "Unique identifier for each call."
        },
        {
          "name": "user_id",
          "type": "UUID",
          "description": "Foreign key linking to the 'users' collection."
        },
        {
          "name": "start_timestamp",
          "type": "Timestamp"
        },
        {
          "name": "duration_seconds",
          "type": "Integer"
        },
        {
          "name": "anonymized_transcript",
          "type": "Array of Objects",
          "description": "A structured log of the conversation with sensitive information redacted.",
          "item_properties": {
            "speaker": "Enum ('ai', 'user')",
            "text": "String",
            "timestamp": "Timestamp"
          }
        },
        {
          "name": "call_summary",
          "type": "String",
          "description": "AI-generated summary of the call's purpose and outcome."
        }
      ]
    },
    "appointments": {
      "description": "Manages all appointment scheduling details.",
      "fields": [
        { "name": "appointment_id", "type": "UUID" },
        {
          "name": "user_id",
          "type": "UUID",
          "description": "Foreign key to the user."
        },
        {
          "name": "agent_id",
          "type": "UUID",
          "description": "Identifier for the assigned internal agent."
        },
        { "name": "start_time", "type": "Timestamp" },
        { "name": "end_time", "type": "Timestamp" },
        {
          "name": "status",
          "type": "Enum ('scheduled', 'confirmed', 'cancelled', 'completed')"
        },
        { "name": "purpose", "type": "String" }
      ]
    },
    "next_steps": {
      "description": "Tracks follow-up actions and tasks.",
      "fields": [
        { "name": "task_id", "type": "UUID" },
        {
          "name": "related_entity_id",
          "type": "UUID",
          "description": "Links to a user, call, or appointment."
        },
        { "name": "assigned_to_agent_id", "type": "UUID" },
        { "name": "description", "type": "String" },
        {
          "name": "status",
          "type": "Enum ('pending', 'in_progress', 'completed')"
        },
        { "name": "due_date", "type": "Timestamp" }
      ]
    }
  }
}
